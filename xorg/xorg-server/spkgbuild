# description	: The core of the X Window system
# depends	: pixman libepoxy xkeyboard-config openssl nettle libxfont2 libinput libgcrypt mesa xorgproto libtirpc

name=xorg-server
version=1.20.5
release=4
source=(http://ftp.x.org/pub/individual/xserver/$name-$version.tar.bz2
	glvnd-arch.patch)
md5sum=(c9fc7e21e11286dbedd22c00df652130
	295fc2a9cf201d13b9d69044211b99ba)

build() {
	cd $name-$version

	# patch taken from Arch
	patch -Np1 -i $SRC/glvnd-arch.patch
	autoreconf -fiv

	./configure \
	    --prefix=/usr \
	    --sysconfdir=/etc \
	    --localstatedir=/var \
	    --libexecdir=/usr/lib/$name \
	    --disable-static \
	    --enable-glamor \
	    --enable-suid-wrapper \
	    --with-xkb-output=/var/lib/xkb
	make
	make DESTDIR=$PKG install

	mkdir -pv $PKG/etc/X11/xorg.conf.d
}
