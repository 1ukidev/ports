# description	: A feature-rich screen recorder that supports X11 and OpenGL
# depends	: ffmpeg glu mesa qt5 cmake libxi libxinerama v4l-utils
# optdepends	: pulseaudio jack

name=simplescreenrecorder
version=0.4.4
release=2
source="https://github.com/MaartenBaert/ssr/archive/$version/ssr-$version.tar.gz
	ffmpeg5.patch"

build() {
	cd ssr-$version

	patch -p1 -i $SRC/ffmpeg5.patch
	[ -e /usr/lib/pkgconfig/libpulse.pc ] || SSRCONF="$SSRCONF -DWITH_PULSEAUDIO=FALSE"
	[ -e /usr/lib/pkgconfig/jack.pc ] || SSRCONF="$SSRCONF -DWITH_JACK=FALSE"

	mkdir build
	cd build

	cmake -DCMAKE_INSTALL_PREFIX="/usr" \
	      -DCMAKE_BUILD_TYPE=Release \
	      -DWITH_QT5=TRUE \
	      ${SSRCONF} \
	..
	make
	make DESTDIR=$PKG install
}

ffmpeg5.patch::https://patch-diff.githubusercontent.com/raw/MaartenBaert/ssr/pull/934.patch
