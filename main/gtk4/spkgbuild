# description	: A multi-platform toolkit for creating graphical user interfaces, version 4
# homepage	: https://www.gtk.org/
# depends	: pango graphene iso-codes libxkbcommon python3-gobject3 adwaita-icon-theme librsvg gst-plugins-bad gdk-pixbuf libepoxy

name=gtk4
version=4.10.0
release=2
source="https://gitlab.gnome.org/GNOME/gtk/-/archive/$version/gtk-$version.tar.bz2
	$name-4.10-wlroots-crash.patch::https://gitlab.gnome.org/GNOME/gtk/-/commit/51902bbce8f93060af8dc8b91199a66c75a29315.patch
	$name-4.10-fix-combobox.patch::https://gitlab.gnome.org/GNOME/gtk/-/commit/5822ba76d0edadec80921cf698e215e25c2cc532.patch"

build() {
	patch -d gtk-$version -Np1 -i $SRC/$name-4.10-wlroots-crash.patch
	patch -d gtk-$version -Np1 -i $SRC/$name-4.10-fix-combobox.patch
	
	venom-meson gtk-$version build \
		-Dbroadway-backend=true \
		-Dwayland-backend=$(scratch isinstalled wayland-protocols && echo true || echo false) \
		-Dman-pages=false \
		-Dbuild-tests=false \
		-Dbuild-examples=false \
		-Ddemos=false
        meson compile -C build
        DESTDIR=$PKG meson install -C build
}
