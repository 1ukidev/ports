# description	: Binary precompiled packages for Rust
# homepage	: https://www.rust-lang.org

name=rust-bin
version=1.71.0
release=1
source="https://static.rust-lang.org/dist/rust-$version-x86_64-unknown-linux-gnu.tar.gz"

build() {
	cd rust-$version-x86_64-unknown-linux-gnu

	./install.sh --prefix=/usr --destdir=$PKG --disable-ldconfig

	# clean up junk files
	mv $PKG/usr/libexec/* $PKG/usr/lib
	rmdir $PKG/usr/libexec
	rm -rf $PKG/usr/share/doc

	# bash completion
	if scratch isinstalled bash-completion 2>/dev/null; then
		mv $PKG/usr/src/etc $PKG
	else
		rm -rf $PKG/usr/src
	fi

	# zsh
	scratch isinstalled zsh || rm -rf $PKG/usr/share/zsh

	# clean rustlib files
	rm -f $PKG/usr/lib/rustlib/install.log \
	      $PKG/usr/lib/rustlib/uninstall.sh
}
