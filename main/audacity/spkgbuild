# description : audacity
# depends	: libsndfile mpg123 wavpack vamp libsoxr suil lilv twolame libsbsms sratom ffmpeg opus wxgtk3 expat lv2 curl sqlite lame portsmf portmidi portaudio flac libogg libvorbis libmad libid3tag zlib

name=audacity
version=3.2.0
release=1
source="https://github.com/$name/$name/archive/refs/tags/Audacity-$version.tar.gz"

build() {
	export LDFLAGS="$LDFLAGS -Wl,-rpath,/usr/lib/audacity,-rpath,/usr/lib/audacity/modules"

	cmake -S $name-Audacity-$version -B build -G Ninja -Wno-dev \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=lib \
		-DCMAKE_BUILD_TYPE=MinSizeRel \
		-DCMAKE_SKIP_RPATH=ON \
		-Daudacity_conan_enabled=OFF \
		-Daudacity_has_vst3=OFF \
		-Daudacity_has_crashreports=OFF \
		-Daudacity_has_networking=OFF \
		-Daudacity_has_sentry_reporting=OFF \
		-Daudacity_has_updates_check=OFF 
	
	LD_LIBRARY_PATH="$PWD/build/utils" \
	cmake --build build
	DESTDIR=$PKG cmake --install build
}
