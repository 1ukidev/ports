# description	: Sound system for POSIX OSes
# depends	: libsndfile alsa-lib dbus glib libcap openssl speexdsp libx11 libxcb libice libsm libxtst json-c

name=pulseaudio
version=11.1
release=1
source=(https://www.freedesktop.org/software/pulseaudio/releases/$name-$version.tar.xz
	http://www.linuxfromscratch.org/patches/blfs/svn/$name-$version-glibc_2.27_fix-1.patch)
md5sum=(390de38231d5cdd6b43ada8939eb74f1
	952e1e975db2fb409ab8580db22cecf4)

build() {
	cd $name-$version

	patch -p1 -i ../$name-$version-glibc_2.27_fix-1.patch

	AUTOPOINT='intltoolize --automake --copy' autoreconf -fiv

	./configure --prefix=/usr        \
                    --sysconfdir=/etc    \
                    --localstatedir=/var \
                    --disable-bluez4     \
                    --disable-bluez5     \
                    --disable-rpath
	make
	make DESTDIR=$PKG install
	
        # remove the D-Bus configuration file for the system wide daemon to avoid creating unnecessary system users and groups
	rm -fv $PKG/etc/dbus-1/system.d/pulseaudio-system.conf
}
